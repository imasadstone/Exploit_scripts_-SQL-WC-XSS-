from WebConfig import crawler2
from XSS import xssFuzz
from SQLi import scanSqlErrorBase
def crawler_url(url, level):
    visited_link = []
    cr = crawler2.Crawler()
    cr.crawl(url, level)
    cr.visited_link.append(url)
    print(visited_link)
    return cr.visited_link

def main():
    # url = 'http://localhost/webapp/showsanpham.php?id=1'
    # url = 'http://localhost/webapp/sayhello.php'
    url = input("Nhập vào url: ")
    urls_check = crawler_url(url, 3)
    print(urls_check)
    for url_check in urls_check:
        scanSqlErrorBase.scan(url_check)
        xssFuzz.scan_xss(url_check)

if __name__ == '__main__':
    main()
